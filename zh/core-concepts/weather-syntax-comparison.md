# Weather è¯­æ³•ç‰ˆæœ¬å¯¹æ¯”

æœ¬æ–‡æ¡£æ¸…æ™°åœ°å¯¹æ¯” Weather è¯­æ³•çš„ä¸¤ä¸ªç‰ˆæœ¬ï¼Œå¸®åŠ©ä½ ç†è§£å“ªäº›å­—æ®µç”¨äºå‰ç«¯å±•ç¤ºï¼Œå“ªäº›å­—æ®µç”¨äºåç«¯å­˜å‚¨ã€‚

---

## ç‰ˆæœ¬æ¦‚è¿°

TradingFlow Weather è¯­æ³•æœ‰ä¸¤ä¸ªç‰ˆæœ¬ï¼š

### ğŸ–¥ï¸ Full ç‰ˆæœ¬ï¼ˆå®Œæ•´ç‰ˆï¼‰
- **ç”¨é€”ï¼š** å‰ç«¯å±•ç¤ºå’Œç”¨æˆ·äº¤äº’
- **åŒ…å«ï¼š** æ‰€æœ‰å­—æ®µï¼ŒåŒ…æ‹¬ UI çŠ¶æ€ã€æ ·å¼é…ç½®ã€è¿è¡Œæ—¶æ•°æ®
- **æ–‡ä»¶å¤§å°ï¼š** è¾ƒå¤§ï¼ŒåŒ…å«å†—ä½™ä¿¡æ¯
- **ä½¿ç”¨åœºæ™¯ï¼š** å‰ç«¯ ReactFlow æ¸²æŸ“ã€ç”¨æˆ·ç¼–è¾‘ã€å®æ—¶çŠ¶æ€å±•ç¤º

### ğŸ’¾ Essential ç‰ˆæœ¬ï¼ˆæ ¸å¿ƒç‰ˆï¼‰
- **ç”¨é€”ï¼š** Agent ç”Ÿæˆå’Œåç«¯å­˜å‚¨
- **åŒ…å«ï¼š** ä»…æ ¸å¿ƒä¸šåŠ¡é€»è¾‘å­—æ®µ
- **æ–‡ä»¶å¤§å°ï¼š** ç²¾ç®€ï¼Œå»é™¤å‰ç«¯ç‰¹å®šå­—æ®µ
- **ä½¿ç”¨åœºæ™¯ï¼š** æ•°æ®åº“å­˜å‚¨ã€API ä¼ è¾“ã€Agent ç”Ÿæˆå·¥ä½œæµ

---

## å­—æ®µå¯¹æ¯”æ€»è§ˆ

### ğŸ“Š å¯¹æ¯”ç»Ÿè®¡

| å±‚çº§ | Full ç‰ˆæœ¬å­—æ®µæ•° | Essential ç‰ˆæœ¬å­—æ®µæ•° | ä¿ç•™ç‡ |
|------|----------------|---------------------|--------|
| é¡¶å±‚ | 4 | 4 | 100% |
| èŠ‚ç‚¹åŸºç¡€ | 8-10 | 4 | 40% |
| èŠ‚ç‚¹ data | 11 | 6 | 55% |
| è¾“å…¥/è¾“å‡º | 9-10 | 8-9 | 90% |
| è¾¹ | 7 | 5 | 71% |

---

## è¯¦ç»†å­—æ®µå¯¹æ¯”

### 1ï¸âƒ£ é¡¶å±‚ç»“æ„

| å­—æ®µ | Full | Essential | è¯´æ˜ |
|------|------|-----------|------|
| `thumbnailUrl` | âœ… | âœ… | å·¥ä½œæµç¼©ç•¥å›¾ï¼ˆå¯é€‰ï¼‰ |
| `name` | âœ… | âœ… | å·¥ä½œæµåç§° |
| `nodes` | âœ… | âœ… | èŠ‚ç‚¹æ•°ç»„ |
| `edges` | âœ… | âœ… | è¾¹æ•°ç»„ |

**ç»“è®ºï¼š** é¡¶å±‚å­—æ®µå…¨éƒ¨ä¿ç•™ï¼Œæ— å˜åŒ–ã€‚

---

### 2ï¸âƒ£ èŠ‚ç‚¹åŸºç¡€å­—æ®µ

| å­—æ®µ | Full | Essential | ç±»å‹ | è¯´æ˜ |
|------|------|-----------|------|------|
| `position` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹ä½ç½®åæ ‡ |
| `id` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹å”¯ä¸€æ ‡è¯† |
| `type` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹ç±»å‹ |
| `data` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹æ•°æ®å¯¹è±¡ |
| `className` | âœ… | âŒ | å‰ç«¯ | CSS ç±»å |
| `width` | âœ… | âŒ | å‰ç«¯ | èŠ‚ç‚¹å®½åº¦ |
| `height` | âœ… | âŒ | å‰ç«¯ | èŠ‚ç‚¹é«˜åº¦ |
| `selected` | âœ… | âŒ | å‰ç«¯ | é€‰ä¸­çŠ¶æ€ |
| `positionAbsolute` | âœ… | âŒ | å‰ç«¯ | ç»å¯¹ä½ç½®ï¼ˆè®¡ç®—å€¼ï¼‰ |
| `dragging` | âœ… | âŒ | å‰ç«¯ | æ‹–æ‹½çŠ¶æ€ |

**ä¿ç•™å­—æ®µï¼š** `position`, `id`, `type`, `data`

**å»é™¤å­—æ®µï¼š** `className`, `width`, `height`, `selected`, `positionAbsolute`, `dragging`

**åŸå› ï¼š** å‰ç«¯ä¼šæ ¹æ®èŠ‚ç‚¹å†…å®¹è‡ªåŠ¨è®¡ç®—å°ºå¯¸å’Œç®¡ç†äº¤äº’çŠ¶æ€ï¼Œæ— éœ€å­˜å‚¨ã€‚

---

### 3ï¸âƒ£ èŠ‚ç‚¹ data å¯¹è±¡

| å­—æ®µ | Full | Essential | ç±»å‹ | è¯´æ˜ |
|------|------|-----------|------|------|
| `title` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹æ ‡é¢˜ |
| `description` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹æè¿° |
| `collection` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹åˆ†ç±» |
| `inputs` | âœ… | âœ… | æ ¸å¿ƒ | è¾“å…¥å‚æ•°æ•°ç»„ |
| `outputs` | âœ… | âœ… | æ ¸å¿ƒ | è¾“å‡ºå®šä¹‰æ•°ç»„ |
| `id` | âœ… | âœ… | æ ¸å¿ƒ | èŠ‚ç‚¹ IDï¼ˆå†—ä½™ï¼‰ |
| `edges` | âœ… | âŒ | å†—ä½™ | èŠ‚ç‚¹ç›¸å…³çš„è¾¹ï¼ˆé¡¶å±‚å·²æœ‰ï¼‰ |
| `menuItems` | âœ… | âŒ | å‰ç«¯ | å³é”®èœå•é¡¹ |
| `isDeepEdit` | âœ… | âŒ | å‰ç«¯ | æ·±åº¦ç¼–è¾‘æ¨¡å¼ |
| `isFlowExecuting` | âœ… | âŒ | å‰ç«¯ | æ‰§è¡ŒçŠ¶æ€ |
| `isStopping` | âœ… | âŒ | å‰ç«¯ | åœæ­¢çŠ¶æ€ |
| `signals` | âœ… | âŒ | è¿è¡Œæ—¶ | è¿è¡Œæ—¶ä¿¡å·æ•°æ® |

**ä¿ç•™å­—æ®µï¼š** `title`, `description`, `collection`, `inputs`, `outputs`, `id`

**å»é™¤å­—æ®µï¼š** `edges`, `menuItems`, `isDeepEdit`, `isFlowExecuting`, `isStopping`, `signals`

**åŸå› ï¼š**
- `edges` - é¡¶å±‚å·²æœ‰å®Œæ•´å®šä¹‰ï¼ŒèŠ‚ç‚¹å†…çš„æ˜¯å†—ä½™å¼•ç”¨
- `menuItems` - å‰ç«¯æ ¹æ®èŠ‚ç‚¹ç±»å‹åŠ¨æ€ç”Ÿæˆ
- `isDeepEdit`, `isFlowExecuting`, `isStopping` - UI çŠ¶æ€ï¼Œä¸å±äºå·¥ä½œæµå®šä¹‰
- `signals` - è¿è¡Œæ—¶æ•°æ®ï¼Œä¸åº”æŒä¹…åŒ–

---

### 4ï¸âƒ£ è¾“å…¥/è¾“å‡ºå­—æ®µ

| å­—æ®µ | Full | Essential | ç±»å‹ | è¯´æ˜ |
|------|------|-----------|------|------|
| `id` | âœ… | âœ… | æ ¸å¿ƒ | å‚æ•°æ ‡è¯†ç¬¦ |
| `title` | âœ… | âœ… | æ ¸å¿ƒ | å‚æ•°æ˜¾ç¤ºå |
| `type` | âœ… | âœ… | æ ¸å¿ƒ | æ•°æ®ç±»å‹ |
| `inputType` | âœ… | âœ… | æ ¸å¿ƒ | è¾“å…¥æ§ä»¶ç±»å‹ |
| `required` | âœ… | âœ… | æ ¸å¿ƒ | æ˜¯å¦å¿…å¡« |
| `placeholder` | âœ… | âœ… | æ ¸å¿ƒ | æç¤ºæ–‡æœ¬ |
| `handle` | âœ… | âœ… | æ ¸å¿ƒ | å¥æŸ„é…ç½® |
| `value` | âœ… | âœ… | æ ¸å¿ƒ | å‚æ•°å€¼ |
| `options` | âœ… | âœ… | æ ¸å¿ƒ | é€‰é¡¹åˆ—è¡¨ |
| `min` | âœ… | âœ… | éªŒè¯ | æœ€å°å€¼ï¼ˆå¯é€‰ï¼‰ |
| `max` | âœ… | âœ… | éªŒè¯ | æœ€å¤§å€¼ï¼ˆå¯é€‰ï¼‰ |
| `description` | âœ… | âœ… | è¯´æ˜ | è¯¦ç»†æè¿°ï¼ˆè¾“å‡ºï¼‰ |
| `isDeleted` | âœ… | âŒ | å‰ç«¯ | åˆ é™¤æ ‡è®° |
| `disabled` | âœ… | âŒ | å‰ç«¯ | ç¦ç”¨çŠ¶æ€ |

**ä¿ç•™å­—æ®µï¼š** `id`, `title`, `type`, `inputType`, `required`, `placeholder`, `handle`, `value`, `options`, `min`, `max`, `description`

**å»é™¤å­—æ®µï¼š** `isDeleted`, `disabled`

**åŸå› ï¼š** `isDeleted` å’Œ `disabled` æ˜¯å‰ç«¯ä¸´æ—¶çŠ¶æ€ï¼ŒçœŸæ­£åˆ é™¤çš„å­—æ®µåº”è¯¥ç›´æ¥ä»æ•°ç»„ä¸­ç§»é™¤ã€‚

---

### 5ï¸âƒ£ è¾¹å­—æ®µ

| å­—æ®µ | Full | Essential | ç±»å‹ | è¯´æ˜ |
|------|------|-----------|------|------|
| `id` | âœ… | âœ… | æ ¸å¿ƒ | è¾¹å”¯ä¸€æ ‡è¯† |
| `source` | âœ… | âœ… | æ ¸å¿ƒ | æºèŠ‚ç‚¹ ID |
| `target` | âœ… | âœ… | æ ¸å¿ƒ | ç›®æ ‡èŠ‚ç‚¹ ID |
| `sourceHandle` | âœ… | âœ… | æ ¸å¿ƒ | æºå¥æŸ„ |
| `targetHandle` | âœ… | âœ… | æ ¸å¿ƒ | ç›®æ ‡å¥æŸ„ |
| `type` | âœ… | âŒ | å‰ç«¯ | è¾¹ç±»å‹ï¼ˆæ ·å¼ï¼‰ |
| `animated` | âœ… | âŒ | å‰ç«¯ | åŠ¨ç”»æ•ˆæœ |

**ä¿ç•™å­—æ®µï¼š** `id`, `source`, `target`, `sourceHandle`, `targetHandle`

**å»é™¤å­—æ®µï¼š** `type`, `animated`

**åŸå› ï¼š** `type` å’Œ `animated` ä»…æ§åˆ¶å‰ç«¯æ¸²æŸ“æ ·å¼å’ŒåŠ¨ç”»ï¼Œä¸å½±å“æ•°æ®æµé€»è¾‘ã€‚

---

## å®é™…å¯¹æ¯”ç¤ºä¾‹

### Full ç‰ˆæœ¬ç¤ºä¾‹ï¼ˆèŠ‚ç‚¹ï¼‰

```json
{
    "position": {"x": 100, "y": 100},
    "positionAbsolute": {"x": 100, "y": 100},
    "id": "x_listener_node_1",
    "type": "x_listener_node",
    "className": "",
    "data": {
        "title": "Trump Twitter Listener",
        "description": "Monitors tweets",
        "collection": "input",
        "inputs": [...],
        "outputs": [...],
        "id": "x_listener_node_1",
        "edges": [...],
        "menuItems": [
            {"key": "delete", "label": "Delete", "danger": true}
        ],
        "isDeepEdit": true,
        "isFlowExecuting": false,
        "isStopping": false,
        "signals": []
    },
    "width": 343,
    "height": 464,
    "selected": false,
    "dragging": false
}
```

### Essential ç‰ˆæœ¬ç¤ºä¾‹ï¼ˆèŠ‚ç‚¹ï¼‰

```json
{
    "position": {"x": 100, "y": 100},
    "id": "x_listener_node_1",
    "type": "x_listener_node",
    "data": {
        "title": "Trump Twitter Listener",
        "description": "Monitors tweets",
        "collection": "input",
        "inputs": [...],
        "outputs": [...]
    }
}
```

**å‡å°‘ï¼š** ä» ~20 ä¸ªå­—æ®µå‡å°‘åˆ° ~7 ä¸ªå­—æ®µï¼Œæ–‡ä»¶å¤§å°å‡å°‘çº¦ 60%ã€‚

---

### Full ç‰ˆæœ¬ç¤ºä¾‹ï¼ˆè¾¹ï¼‰

```json
{
    "id": "edge_ai_model_node_1_ai_response_to_buy_node_1_buy_token",
    "type": "default",
    "animated": true,
    "source": "ai_model_node_1",
    "target": "buy_node_1",
    "sourceHandle": "ai_response",
    "targetHandle": "buy_token"
}
```

### Essential ç‰ˆæœ¬ç¤ºä¾‹ï¼ˆè¾¹ï¼‰

```json
{
    "id": "edge_ai_model_node_1_ai_response_to_buy_node_1_buy_token",
    "source": "ai_model_node_1",
    "target": "buy_node_1",
    "sourceHandle": "ai_response",
    "targetHandle": "buy_token"
}
```

**å‡å°‘ï¼š** ä» 7 ä¸ªå­—æ®µå‡å°‘åˆ° 5 ä¸ªå­—æ®µã€‚

---

## è½¬æ¢è§„åˆ™

### Full â†’ Essential è½¬æ¢

åç«¯åœ¨å­˜å‚¨å‰ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ¸…ç†ï¼š

```typescript
function toEssential(fullFlow: FullFlow): EssentialFlow {
    return {
        thumbnailUrl: fullFlow.thumbnailUrl,
        name: fullFlow.name,
        nodes: fullFlow.nodes.map(node => ({
            position: node.position,
            id: node.id,
            type: node.type,
            data: {
                title: node.data.title,
                description: node.data.description,
                collection: node.data.collection,
                inputs: node.data.inputs.map(cleanInput),
                outputs: node.data.outputs.map(cleanOutput)
            }
        })),
        edges: fullFlow.edges.map(edge => ({
            id: edge.id,
            source: edge.source,
            target: edge.target,
            sourceHandle: edge.sourceHandle,
            targetHandle: edge.targetHandle
        }))
    };
}
```

### Essential â†’ Full è½¬æ¢

å‰ç«¯åŠ è½½åä¼šè‡ªåŠ¨è¡¥å……å‰ç«¯å­—æ®µï¼š

```typescript
function toFull(essentialFlow: EssentialFlow): FullFlow {
    return {
        ...essentialFlow,
        nodes: essentialFlow.nodes.map(node => ({
            ...node,
            className: "",
            width: calculateWidth(node),
            height: calculateHeight(node),
            selected: false,
            data: {
                ...node.data,
                id: node.id,
                edges: [], // ä»é¡¶å±‚ edges å¡«å……
                menuItems: getDefaultMenuItems(),
                isDeepEdit: false,
                isFlowExecuting: false,
                isStopping: false,
                signals: []
            }
        })),
        edges: essentialFlow.edges.map(edge => ({
            ...edge,
            type: "default",
            animated: false
        }))
    };
}
```

---

## ç‰¹æ®Šè¯´æ˜

### 1. edges å­—æ®µçš„ç‰¹æ®Šå¤„ç†

**èŠ‚ç‚¹å†…çš„ `data.edges` æ•°ç»„ï¼š**
- Full ç‰ˆæœ¬ï¼šåŒ…å«è¯¥èŠ‚ç‚¹ç›¸å…³çš„æ‰€æœ‰è¾¹çš„å®Œæ•´ä¿¡æ¯ï¼ˆå†—ä½™ï¼‰
- Essential ç‰ˆæœ¬ï¼š**å®Œå…¨ç§»é™¤**ï¼Œå› ä¸ºé¡¶å±‚ `edges` æ•°ç»„å·²åŒ…å«æ‰€æœ‰ä¿¡æ¯

å‰ç«¯ä¼šæ ¹æ®é¡¶å±‚ `edges` è‡ªåŠ¨å¡«å……æ¯ä¸ªèŠ‚ç‚¹çš„ `data.edges`ã€‚

### 2. å¯é€‰å­—æ®µçš„å¤„ç†

æŸäº›å­—æ®µåœ¨ Essential ç‰ˆæœ¬ä¸­æ˜¯å¯é€‰çš„ï¼š
- `thumbnailUrl` - å¦‚æœæ²¡æœ‰åˆ™å‰ç«¯è‡ªåŠ¨ç”Ÿæˆ
- `placeholder` - å¦‚æœæ²¡æœ‰åˆ™æ˜¾ç¤ºé»˜è®¤æç¤º
- `options` - å¦‚æœæ˜¯ç©ºæ•°ç»„å¯ä»¥çœç•¥

### 3. å‘åå…¼å®¹

å¦‚æœ Essential ç‰ˆæœ¬ä¸­åŒ…å«äº†å‰ç«¯å­—æ®µï¼ˆå¦‚ `width`ã€`selected`ï¼‰ï¼Œå‰ç«¯ä¼šï¼š
- ä¼˜å…ˆä½¿ç”¨ Essential ç‰ˆæœ¬ä¸­çš„å€¼
- å¦‚æœç¼ºå¤±åˆ™ä½¿ç”¨é»˜è®¤å€¼æˆ–è®¡ç®—å€¼

---

## æœ€ä½³å®è·µ

### Agent ç”Ÿæˆæ—¶

âœ… **æ¨èï¼š**
```json
{
    "name": "Trump Trading Strategy",
    "nodes": [
        {
            "position": {"x": 100, "y": 100},
            "id": "x_listener_node_1",
            "type": "x_listener_node",
            "data": {
                "title": "Twitter Listener",
                "description": "Monitors tweets",
                "collection": "input",
                "inputs": [...],
                "outputs": [...]
            }
        }
    ],
    "edges": [...]
}
```

âŒ **é¿å…ï¼š**
```json
{
    "name": "Trump Trading Strategy",
    "nodes": [
        {
            "position": {"x": 100, "y": 100},
            "id": "x_listener_node_1",
            "type": "x_listener_node",
            "width": 343,  // âŒ ä¸éœ€è¦
            "selected": false,  // âŒ ä¸éœ€è¦
            "data": {
                "title": "Twitter Listener",
                "isDeepEdit": true,  // âŒ ä¸éœ€è¦
                "signals": []  // âŒ ä¸éœ€è¦
            }
        }
    ]
}
```

### åç«¯å­˜å‚¨æ—¶

- å§‹ç»ˆå­˜å‚¨ Essential ç‰ˆæœ¬
- åœ¨ API å“åº”æ—¶ä¿æŒ Essential æ ¼å¼
- è®©å‰ç«¯è´Ÿè´£è¡¥å…… UI ç›¸å…³å­—æ®µ

### å‰ç«¯å¤„ç†æ—¶

- ä»åç«¯åŠ è½½ Essential ç‰ˆæœ¬
- è‡ªåŠ¨è½¬æ¢ä¸º Full ç‰ˆæœ¬ç”¨äºæ¸²æŸ“
- ä¿å­˜æ—¶è½¬æ¢å› Essential ç‰ˆæœ¬

---

## æ–‡ä»¶å¤§å°å¯¹æ¯”

ä»¥ä¸€ä¸ªåŒ…å« 7 ä¸ªèŠ‚ç‚¹ã€7 æ¡è¾¹çš„å·¥ä½œæµä¸ºä¾‹ï¼š

| ç‰ˆæœ¬ | æ–‡ä»¶å¤§å° | å‹ç¼©å | èŠ‚çœ |
|------|----------|--------|------|
| Full | ~25 KB | ~8 KB | - |
| Essential | ~10 KB | ~4 KB | 60% |

**ç»“è®ºï¼š** Essential ç‰ˆæœ¬å¯ä»¥æ˜¾è‘—å‡å°‘å­˜å‚¨ç©ºé—´å’Œç½‘ç»œä¼ è¾“å¼€é”€ã€‚

---

## å¿«é€Ÿå‚è€ƒè¡¨

### éœ€è¦å»é™¤çš„å­—æ®µæ¸…å•

**èŠ‚ç‚¹çº§åˆ«ï¼š**
- âŒ `className`
- âŒ `width`
- âŒ `height`
- âŒ `selected`
- âŒ `positionAbsolute`
- âŒ `dragging`

**data çº§åˆ«ï¼š**
- âŒ `data.edges`
- âŒ `data.menuItems`
- âŒ `data.isDeepEdit`
- âŒ `data.isFlowExecuting`
- âŒ `data.isStopping`
- âŒ `data.signals`

**è¾“å…¥/è¾“å‡ºçº§åˆ«ï¼š**
- âŒ `isDeleted`
- âŒ `disabled`

**è¾¹çº§åˆ«ï¼š**
- âŒ `type`
- âŒ `animated`

---

**ç›¸å…³æ–‡æ¡£ï¼š**
- [Weather è¯­æ³•ï¼ˆFull ç‰ˆæœ¬ï¼‰](weather-syntax.md) - å®Œæ•´å­—æ®µè¯´æ˜
- [èŠ‚ç‚¹ä¸å·¥ä½œæµ](nodes-and-workflows.md) - æ¦‚å¿µä»‹ç»
