# Buy Node

Buy Node æ˜¯ä¸“é—¨ç”¨äºä¹°å…¥ä»£å¸çš„äº¤æ˜“æ‰§è¡ŒèŠ‚ç‚¹ï¼Œæ˜¯ Swap Node çš„å®ä¾‹èŠ‚ç‚¹ã€‚å®ƒæä¾›æ¸…æ™°çš„ä¹°å…¥è¯­ä¹‰ï¼Œç®€åŒ–äº†ä»£å¸è´­ä¹°æ“ä½œçš„é…ç½®ã€‚

---

## èŠ‚ç‚¹ä¿¡æ¯

| å±æ€§         | å€¼                              |
| ------------ | ------------------------------- |
| **èŠ‚ç‚¹ç±»å‹** | `buy_node`                      |
| **æ˜¾ç¤ºåç§°** | Buy                             |
| **èŠ‚ç‚¹åˆ†ç±»** | Tradeï¼ˆäº¤æ˜“æ‰§è¡Œï¼‰               |
| **å›¾æ ‡**     | ğŸ“ˆ ä¸Šæ¶¨è¶‹åŠ¿å›¾æ ‡                 |
| **å¥æŸ„é¢œè‰²** | Amberï¼ˆæ©™è‰²ï¼‰ / Emeraldï¼ˆç»¿è‰²ï¼‰ |
| **èŠ‚ç‚¹ç±»åˆ«** | Instance Nodeï¼ˆå®ä¾‹èŠ‚ç‚¹ï¼‰       |
| **åŸºç±»èŠ‚ç‚¹** | `swap_node`                     |

---

## åŠŸèƒ½è¯´æ˜

Buy Node ä¸“é—¨ç”¨äºä¹°å…¥ä»£å¸æ“ä½œï¼Œå†…éƒ¨ä½¿ç”¨ Swap Node çš„å®Œæ•´äº¤æ¢åŠŸèƒ½ï¼Œä½†æä¾›äº†æ›´ç›´è§‚çš„å‚æ•°å‘½åã€‚ç”¨æˆ·åªéœ€æŒ‡å®šè¦ä¹°å…¥çš„ä»£å¸å’Œæ”¯ä»˜çš„ä»£å¸ï¼ŒèŠ‚ç‚¹è‡ªåŠ¨å¤„ç†äº¤æ¢é€»è¾‘ã€‚

**ä¸»è¦ç”¨é€”ï¼š**

- ä¹°å…¥ç›®æ ‡ä»£å¸
- æ¸…æ™°çš„ä¹°å…¥è¯­ä¹‰
- ç®€åŒ–å‚æ•°é…ç½®
- è‡ªåŠ¨å¤„ç†äº¤æ¢æ–¹å‘

**æ ¸å¿ƒç‰¹æ€§ï¼š**

- ğŸ’° **ä¹°å…¥è¯­ä¹‰**ï¼š`buy_token` å’Œ `base_token` å‚æ•°æ›´ç›´è§‚
- ğŸ”„ **è‡ªåŠ¨æ˜ å°„**ï¼šå†…éƒ¨è½¬æ¢ä¸º Swap Node çš„ from/to å‚æ•°
- ğŸ“Š **å®Œæ•´åŠŸèƒ½**ï¼šç»§æ‰¿ Swap Node çš„æ‰€æœ‰åŠŸèƒ½
- ğŸ¯ **ä¸“æ³¨ä¹°å…¥**ï¼šä¼˜åŒ–çš„ç”¨æˆ·ä½“éªŒ

---

## ä¸ Swap Node çš„å…³ç³»

Buy Node æ˜¯ Swap Node çš„**å®ä¾‹èŠ‚ç‚¹**ï¼Œå…³ç³»å¦‚ä¸‹ï¼š

```
SwapNode (åŸºç±»)
    â”œâ”€ from_token (æºä»£å¸)
    â””â”€ to_token (ç›®æ ‡ä»£å¸)
        â†“ å®ä¾‹åŒ–
BuyNode (å®ä¾‹)
    â”œâ”€ base_token â†’ from_token (ç”¨ä»€ä¹ˆä¹°)
    â””â”€ buy_token â†’ to_token (ä¹°ä»€ä¹ˆ)
```

**å‚æ•°æ˜ å°„ï¼š**

- `base_token` â†’ `from_token`ï¼ˆæ”¯ä»˜çš„ä»£å¸ï¼‰
- `buy_token` â†’ `to_token`ï¼ˆä¹°å…¥çš„ä»£å¸ï¼‰

**ç»§æ‰¿çš„åŠŸèƒ½ï¼š**

- æ™ºèƒ½æ± å­æœç´¢
- åŠ¨æ€ä»·æ ¼è®¡ç®—
- æ»‘ç‚¹ä¿æŠ¤
- å¤šé“¾æ”¯æŒ
- å®Œæ•´çš„äº¤æ˜“æ”¶æ®

---

## è¾“å…¥å‚æ•°

### å‚æ•°åˆ—è¡¨

| å‚æ•°                       | ç±»å‹         | å¿…å¡« | é»˜è®¤å€¼                     | è¯´æ˜                                   |
| -------------------------- | ------------ | ---- | -------------------------- | -------------------------------------- |
| `buy_token`                | searchSelect | âœ…   | -                          | è¦ä¹°å…¥çš„ä»£å¸ç¬¦å·                       |
| `base_token`               | searchSelect | âœ…   | -                          | ç”¨äºæ”¯ä»˜çš„ä»£å¸ç¬¦å·                     |
| `chain`                    | searchSelect | âœ…   | `aptos`                    | åŒºå—é“¾ç½‘ç»œ                             |
| `vault_address`            | text         | âœ…   | -                          | é‡‘åº“åœ°å€                               |
| `amount_in_human_readable` | **switch**   | âœ…   | `{mode:"number",value:""}` | æ”¯ä»˜é‡‘é¢ï¼ˆNumber/Percentage æ¨¡å¼åˆ‡æ¢ï¼‰ |
| `slippery`                 | number       | âœ…   | `1.0`                      | æ»‘ç‚¹å®¹å¿åº¦ï¼ˆ%ï¼‰                        |
| `order_type`               | select       | âœ…   | `market`                   | è®¢å•ç±»å‹                               |
| `limited_price`            | number       | âŒ   | -                          | é™ä»·ï¼ˆæœªå®ç°ï¼‰                         |

### buy_token å‚æ•°

**è¯´æ˜ï¼š** æ‚¨æƒ³è¦ä¹°å…¥çš„ä»£å¸ç¬¦å·

**ç¤ºä¾‹ï¼š**

- `APT` - ä¹°å…¥ Aptos Coin
- `BTC` - ä¹°å…¥ Bitcoin
- `ETH` - ä¹°å…¥ Ethereum

### base_token å‚æ•°

**è¯´æ˜ï¼š** ç”¨äºæ”¯ä»˜çš„ä»£å¸ç¬¦å·ï¼ˆ"ç”¨ä»€ä¹ˆä¹°"ï¼‰

**ç¤ºä¾‹ï¼š**

- `USDT` - ä½¿ç”¨ USDT æ”¯ä»˜
- `USDC` - ä½¿ç”¨ USDC æ”¯ä»˜
- `APT` - ä½¿ç”¨ APT æ”¯ä»˜

### amount_in_human_readable å‚æ•°

**è¯´æ˜ï¼š** æ”¯ä»˜é‡‘é¢ï¼Œæ”¯æŒä¸¤ç§æ¨¡å¼ï¼šç²¾ç¡®æ•°é‡ï¼ˆNumberï¼‰å’Œç™¾åˆ†æ¯”ï¼ˆPercentageï¼‰

**ç±»å‹ï¼š** Switchï¼ˆæ¨¡å¼åˆ‡æ¢å™¨ï¼‰

**æ•°æ®ç»“æ„ï¼š**

```typescript
{
  mode: "number" | "percentage",  // æ¨¡å¼ï¼šç²¾ç¡®æ•°é‡ æˆ– ç™¾åˆ†æ¯”
  value: string                    // æ•°å€¼ï¼ˆå­—ç¬¦ä¸²å½¢å¼ï¼‰
}
```

**æ¨¡å¼ 1ï¼šNumberï¼ˆç²¾ç¡®æ•°é‡ï¼‰**

æŒ‡å®šç²¾ç¡®çš„ `base_token` æ•°é‡è¿›è¡Œæ”¯ä»˜ã€‚

```json
{
  "buy_token": "APT",
  "base_token": "USDT",
  "amount_in_human_readable": {
    "mode": "number",
    "value": "100"
  }
}
// å«ä¹‰ï¼šä½¿ç”¨ 100 USDT ä¹°å…¥ APT
```

**æ¨¡å¼ 2ï¼šPercentageï¼ˆç™¾åˆ†æ¯”ï¼‰**

æŒ‰ `base_token` ä½™é¢çš„ç™¾åˆ†æ¯”è¿›è¡Œæ”¯ä»˜ï¼ˆ0-100ï¼‰ã€‚

```json
{
  "buy_token": "APT",
  "base_token": "USDT",
  "amount_in_human_readable": {
    "mode": "percentage",
    "value": "50"
  }
}
// å«ä¹‰ï¼šä½¿ç”¨ 50% çš„ USDT ä½™é¢ä¹°å…¥ APT
```

**å‰ç«¯ UIï¼š**

- ç”¨æˆ·é¦–å…ˆé€‰æ‹©æ¨¡å¼ï¼ˆNumber æˆ– Percentageï¼‰
- Number æ¨¡å¼ï¼šæ˜¾ç¤ºæ•°å­—è¾“å…¥æ¡†
- Percentage æ¨¡å¼ï¼šæ˜¾ç¤º 0-100% æ»‘å— + è¾“å…¥æ¡†

**é€‰æ‹©å»ºè®®ï¼š**

- ç²¾ç¡®æ§åˆ¶æˆæœ¬ â†’ ä½¿ç”¨ `number` æ¨¡å¼
- åŠ¨æ€è°ƒæ•´ä»“ä½ â†’ ä½¿ç”¨ `percentage` æ¨¡å¼

### order_type å‚æ•°

**æ”¯æŒçš„ç±»å‹ï¼š**

| å€¼       | è¯´æ˜   | çŠ¶æ€      |
| -------- | ------ | --------- |
| `market` | å¸‚ä»·å• | âœ… å·²å®ç° |
| `limit`  | é™ä»·å• | â³ æœªå®ç° |

**è¯´æ˜ï¼š**

- å½“å‰ä»…æ”¯æŒå¸‚ä»·å•
- é™ä»·å•åŠŸèƒ½è®¡åˆ’ä¸­

---

## è¾“å‡ºå‚æ•°

### è¾“å‡ºåˆ—è¡¨

| è¾“å‡º ID         | æ˜¾ç¤ºåç§°      | æ•°æ®ç±»å‹ | è¯´æ˜           |
| --------------- | ------------- | -------- | -------------- |
| `trade_receipt` | Trade Receipt | object   | å®Œæ•´çš„äº¤æ˜“æ”¶æ® |

### trade_receipt è¾“å‡º

**æ•°æ®ç»“æ„ä¸ Swap Node å®Œå…¨ç›¸åŒ**ï¼Œå‚è§ [Swap Node æ–‡æ¡£](swap-node.md#trade_receipt-è¾“å‡º)ã€‚

**å…³é”®å­—æ®µï¼š**

- `from_token`: `base_token` å€¼
- `to_token`: `buy_token` å€¼
- `amount_in`: å®é™…æ”¯ä»˜é‡‘é¢
- `amount_out`: å®é™…ä¹°å…¥æ•°é‡
- `tx_hash`: äº¤æ˜“å“ˆå¸Œ

---

## ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹ 1ï¼šä½¿ç”¨ USDT ä¹°å…¥ APT

**åœºæ™¯ï¼š** èŠ±è´¹ 100 USDT è´­ä¹° APTã€‚

**å·¥ä½œæµç»“æ„ï¼š**

```
Vault Node (Aptos)
    â†“ vault_address
Buy Node (ä¹°å…¥ APT)
    â†“ trade_receipt
Telegram Sender Node (å‘é€é€šçŸ¥)
```

**Buy Node é…ç½®ï¼š**

```json
{
  "buy_token": "APT",
  "base_token": "USDT",
  "amount_in_human_readable": {
    "mode": "number",
    "value": "100"
  },
  "slippery": 1.0,
  "chain": "aptos"
}
```

**äº¤æ˜“ç†è§£ï¼š**

- ç”¨ **100 USDT** ä¹°å…¥ **APT**
- æ ¹æ®å½“å‰ä»·æ ¼ï¼Œé¢„è®¡ä¹°å…¥çº¦ 13.79 APTï¼ˆå‡è®¾ APT=$7.25ï¼‰
- æ»‘ç‚¹ä¿æŠ¤ï¼šè‡³å°‘ä¹°å…¥ 13.65 APT

---

### ç¤ºä¾‹ 2ï¼šä½¿ç”¨ 50% ä½™é¢ä¹°å…¥

**åœºæ™¯ï¼š** ä½¿ç”¨å½“å‰ USDT ä½™é¢çš„ 50% ä¹°å…¥ BTCã€‚

**Buy Node é…ç½®ï¼š**

```json
{
  "buy_token": "BTC",
  "base_token": "USDT",
  "amount_in_human_readable": {
    "mode": "percentage",
    "value": "50"
  },
  "slippery": 0.5,
  "chain": "aptos"
}
```

**æ‰§è¡Œè¿‡ç¨‹ï¼š**

```
1. æŸ¥è¯¢é‡‘åº“ USDT ä½™é¢ï¼š1000 USDT
2. è®¡ç®—æ”¯ä»˜é‡‘é¢ï¼š1000 * 50% = 500 USDT
3. æ‰§è¡Œä¹°å…¥ï¼š500 USDT â†’ BTC
```

---

### ç¤ºä¾‹ 3ï¼šAI æ¨èä¹°å…¥

**åœºæ™¯ï¼š** AI åˆ†æåæ¨èä¹°å…¥æŸä¸ªä»£å¸ã€‚

**å·¥ä½œæµç»“æ„ï¼š**

```
X Listener Node (ç›‘å¬KOLæ¨æ–‡)
    â†“ latest_tweets
AI Model Node (åˆ†ææ¨æ–‡)
    â†“ ai_response { buy_token: "BTC", amount: 100 }
    â†“
Vault Node (è·å–é‡‘åº“)
    â†“ vault_address
    â†“
Buy Node (æ‰§è¡Œä¹°å…¥)
    â†“ trade_receipt
Dataset Output Node (ä¿å­˜è®°å½•)
```

**AI Model Node è¾“å‡ºï¼š**

```json
{
  "buy_token": "BTC",
  "base_token": "USDT",
  "amount": 100.0,
  "confidence": 0.85,
  "reason": "æŠ€æœ¯é¢çªç ´å…³é”®é˜»åŠ›ä½"
}
```

---

### ç¤ºä¾‹ 4ï¼šæ¡ä»¶ä¹°å…¥

**åœºæ™¯ï¼š** ä»·æ ¼ä½äºæŸä¸ªå€¼æ—¶ä¹°å…¥ã€‚

**å·¥ä½œæµç»“æ„ï¼š**

```
Binance Price Node (è·å– BTC ä»·æ ¼)
    â†“ kline_data
Code Node (æ£€æŸ¥ä»·æ ¼)
    â†“ should_buy (true/false)
Condition Node (ä»·æ ¼ < $50,000?)
    â†“ (true)
    â”œâ”€â†’ Vault Node â†’ Buy Node (ä¹°å…¥)
    â†“ (false)
    â””â”€â†’ ä¸æ‰§è¡Œ
```

---

## æœ€ä½³å®è·µ

### 1. å‚æ•°å‘½åç†è§£

**Buy Node è¯­ä¹‰ï¼š**

```
æˆ‘è¦ç”¨ [base_token] ä¹°å…¥ [buy_token]
```

**ç¤ºä¾‹ï¼š**

- ç”¨ **USDT** ä¹°å…¥ **APT** âœ… æ¸…æ™°
- ä¹°å…¥ **APT** ç”¨ **USDT** âœ… åŒä¹‰

### 2. ä¸ Swap Node å¯¹æ¯”

**Buy Nodeï¼ˆæ¨èç”¨äºä¹°å…¥ï¼‰ï¼š**

```json
{
  "buy_token": "APT",
  "base_token": "USDT",
  "amount_in_human_readable": 100.0
}
```

**Swap Nodeï¼ˆé€šç”¨äº¤æ¢ï¼‰ï¼š**

```json
{
  "from_token": "USDT",
  "to_token": "APT",
  "amount_in_human_readable": 100.0
}
```

**é€‰æ‹©å»ºè®®ï¼š**

- æ˜ç¡®çš„ä¹°å…¥æ“ä½œ â†’ ä½¿ç”¨ Buy Node
- åŒå‘äº¤æ¢æ“ä½œ â†’ ä½¿ç”¨ Swap Node
- AI ç”Ÿæˆçš„å·¥ä½œæµ â†’ Buy Node è¯­ä¹‰æ›´æ¸…æ™°

### 3. é‡‘é¢è®¾ç½®

**å›ºå®šé‡‘é¢ä¹°å…¥ï¼ˆNumber æ¨¡å¼ï¼‰ï¼š**

```json
{
  "amount_in_human_readable": {
    "mode": "number",
    "value": "100"
  }
}
// èŠ±è´¹å›ºå®š 100 USDT
```

**æ¯”ä¾‹ä¹°å…¥ï¼ˆPercentage æ¨¡å¼ï¼‰ï¼š**

```json
{
  "amount_in_human_readable": {
    "mode": "percentage",
    "value": "30"
  }
}
// èŠ±è´¹ USDT ä½™é¢çš„ 30%
```

**å»ºè®®ï¼š**

- ç²¾ç¡®æ§åˆ¶æˆæœ¬ â†’ ä½¿ç”¨ `number` æ¨¡å¼
- åŠ¨æ€è°ƒæ•´ä»“ä½ â†’ ä½¿ç”¨ `percentage` æ¨¡å¼

---

## æ³¨æ„äº‹é¡¹

### âš ï¸ é‡è¦æç¤º

1. **å‚æ•°æ–¹å‘ç†è§£**

   - `base_token` æ˜¯æ”¯ä»˜çš„ä»£å¸ï¼ˆå‡å°‘ï¼‰
   - `buy_token` æ˜¯ä¹°å…¥çš„ä»£å¸ï¼ˆå¢åŠ ï¼‰
   - é‡‘é¢å‚æ•°æŒ‡çš„æ˜¯ `base_token` çš„æ•°é‡

2. **ä¸ Sell Node çš„åŒºåˆ«**

   - Buy Node: è·å¾—ç›®æ ‡ä»£å¸
   - Sell Node: å–å‡ºæŒæœ‰ä»£å¸
   - å†…éƒ¨å®ç°ç›¸åŒï¼Œè¯­ä¹‰ç›¸å

3. **ç»§æ‰¿çš„é™åˆ¶**

   - æ‰€æœ‰ Swap Node çš„é™åˆ¶éƒ½é€‚ç”¨
   - æ»‘ç‚¹ã€Gasã€æµåŠ¨æ€§ç­‰è¦æ±‚ç›¸åŒ
   - å‚è§ [Swap Node æ³¨æ„äº‹é¡¹](swap-node.md#æ³¨æ„äº‹é¡¹)

4. **è®¢å•ç±»å‹**
   - å½“å‰ä»…æ”¯æŒå¸‚ä»·å•
   - é™ä»·å•ï¼ˆ`limit`ï¼‰åŠŸèƒ½æœªå®ç°
   - `limited_price` å‚æ•°æš‚æ—¶æ— æ•ˆ

---

## æ•…éšœæ’æŸ¥

**Q: æç¤ºå‚æ•°é”™è¯¯ï¼Ÿ**

A:

1. ç¡®è®¤æä¾›äº† `buy_token` å’Œ `base_token`
2. æ£€æŸ¥ä»£å¸ç¬¦å·æ˜¯å¦æ­£ç¡®
3. ç¡®ä¿é‡‘é¢å‚æ•°æœ‰æ•ˆ

---

**Q: ä¹°å…¥æ•°é‡ä¸é¢„æœŸä¸ç¬¦ï¼Ÿ**

A:

1. æ£€æŸ¥å½“å‰å¸‚åœºä»·æ ¼
2. ç¡®è®¤ `amount_in` æ˜¯ base_token çš„æ•°é‡
3. æ»‘ç‚¹ä¼šå½±å“æœ€ç»ˆä¹°å…¥æ•°é‡
4. æŸ¥çœ‹ `trade_receipt.amount_out` è·å–å®é™…æ•°é‡

---

**Q: åº”è¯¥ä½¿ç”¨ Buy Node è¿˜æ˜¯ Swap Nodeï¼Ÿ**

A:

- **ä½¿ç”¨ Buy Node**ï¼š

  - âœ… æ˜ç¡®çš„ä¹°å…¥æ“ä½œ
  - âœ… å‰ç«¯ç”¨æˆ·ç•Œé¢
  - âœ… AI ç”Ÿæˆçš„å·¥ä½œæµ

- **ä½¿ç”¨ Swap Node**ï¼š
  - âœ… éœ€è¦çµæ´»çš„äº¤æ¢æ–¹å‘
  - âœ… ç¨‹åºåŒ–äº¤æ˜“
  - âœ… åŸºäºå…¶ä»–èŠ‚ç‚¹è¾“å‡ºçš„äº¤æ¢

---

## æŠ€æœ¯è§„æ ¼

| è§„æ ¼é¡¹         | å€¼                         |
| -------------- | -------------------------- |
| **èŠ‚ç‚¹ç‰ˆæœ¬**   | 0.0.2                      |
| **èŠ‚ç‚¹ç±»åˆ«**   | Instance Node              |
| **åŸºç±»èŠ‚ç‚¹**   | `swap_node`                |
| **ç»§æ‰¿åŠŸèƒ½**   | 100%                       |
| **æ”¯æŒçš„é“¾**   | Aptos, Flow EVM            |
| **æ”¯æŒçš„ DEX** | Hyperion (Aptos), Flow DEX |

---

## ç›¸å…³èŠ‚ç‚¹

- **[Swap Node](swap-node.md)** - åŸºç±»èŠ‚ç‚¹ï¼Œé€šç”¨ä»£å¸äº¤æ¢
- **[Sell Node](sell-node.md)** - å–å‡ºä»£å¸çš„å®ä¾‹èŠ‚ç‚¹
- **[Vault Node](vault-node.md)** - é‡‘åº“ç®¡ç†èŠ‚ç‚¹
- **Code Node** - é¢„å¤„ç†äº¤æ˜“å‚æ•°
- **Condition Node** - æ¡ä»¶åˆ¤æ–­

---

**ç›¸å…³æ–‡æ¡£ï¼š**

- [èŠ‚ç‚¹ä¸å·¥ä½œæµ](../core-concepts/nodes-and-workflows.md) - èŠ‚ç‚¹åŸºç¡€æ¦‚å¿µ
- [Swap Node](swap-node.md) - åŸºç±»èŠ‚ç‚¹å®Œæ•´æ–‡æ¡£
- [Weather è¯­æ³•](../core-concepts/weather-syntax.md) - å·¥ä½œæµæ–‡ä»¶æ ¼å¼
